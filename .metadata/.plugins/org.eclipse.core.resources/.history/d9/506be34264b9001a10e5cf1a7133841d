package com.ms.boot.ConvertCurrencyms.controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpHeaders;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;


import com.ms.boot.CurrencyConvertms.service.CurrencyConvertService;
import com.ms.boot.CurrencyConvertms.model.CurrencyConvertDTO;
import com.ms.boot.CurrencyConvertms.repo.CurrencyConvertRepository;

import java.util.List;
import java.util.Optional;

import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RestController;

@RestController
//@RequestMapping("/currencyconversion")
public class CurrencyConvertController {

//@Autowired
CurrencyConvertService service =new CurrencyConvertService();
CurrencyConvertDTO dto =new CurrencyConvertDTO();
@Autowired
    CurrencyConvertRepository repository;
@Autowired
JdbcTemplate jdbcTemplate;

      @GetMapping("/currencyconversion/countrycode/{countrycode}")
      public CurrencyConvertDTO getConversionFactor(@PathVariable("countrycode") String countrycode) 
                                                      throws ResponseStatus {
    
    	  
    	  return jdbcTemplate.queryForObject("select countrycode,conversionFactor from currconversion where countrycode=?",new Object []{
    		  countrycode
    	  } ,new BeanPropertyRowMapper <CurrencyConvertDTO> (CurrencyConvertDTO.class));
      }
      
     
 
      @GetMapping("/currencyconversion/countrycode/{countrycode}/conversionFactor/{conversionFactor}")
       public int AddConversionFactor(CurrencyConvertDTO dto) throws ResponseStatus {
     
     	  
     	  return jdbcTemplate.update("insert into currconversion(countrycode, conversionFactor)" + " values(? , ?)",new Object []{
     			  dto.getCountrycode(),dto.getConversionFactor()
     	  } );
       
       }
       
      @RequestMapping("/currencyconversion/conversionFactor/{conversionFactor}/countrycode/{countrycode}")
       public int UpdateConversionFactor(CurrencyConvertDTO dto) throws ResponseStatus {
      
	  
	  return jdbcTemplate.update("update currconversion set conversionFactor= ?" + " where countrycode= ? ",new Object []{
		  dto.getConversionFactor(),dto.getCountrycode()
	  } );
  }

} 

   

   




